<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AML · Fraud Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --system-blue: #007AFF;
      --system-red: #FF3B30;
      --system-orange: #FF9500;
      --system-green: #34C759;
      --bg-gray: #F2F2F7;
      --card-white: #FFFFFF;
      --text-primary: #1C1C1E;
      --text-secondary: #8E8E93;
      --transition-spring: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      background: var(--bg-gray);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
      color: var(--text-primary);
      display: flex;
      justify-content: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Smooth Page Transitions */
    .fade-in {
      animation: appleFade 0.6s ease-out forwards;
    }

    @keyframes appleFade {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .app-container {
      width: 100%;
      max-width: 430px; /* iPhone 15 Pro Max width approx */
      background: var(--bg-gray);
      min-height: 100vh;
      padding: 20px 16px 120px;
      position: relative;
    }

    /* Typography */
    h1 { font-size: 34px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 20px; }
    h2 { font-size: 20px; font-weight: 600; margin: 24px 0 12px; }

    /* Glassmorphism/Apple Cards */
    .card {
      background: var(--card-white);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.04);
      transition: var(--transition-spring);
    }

    .card:active {
      transform: scale(0.98);
      background: #fafafa;
    }

    /* Balance Section */
    .balance-label { font-size: 13px; color: var(--text-secondary); text-transform: uppercase; font-weight: 600; }
    .balance-val { font-size: 40px; font-weight: 800; margin: 4px 0; letter-spacing: -1px; }

    /* Action Buttons - Pill style */
    .action-row { display: flex; gap: 8px; margin-top: 16px; }
    .btn-capsule {
      flex: 1;
      background: #E9E9EB;
      border: none;
      padding: 10px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      color: var(--system-blue);
    }

    /* History List */
    .tx-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 0.5px solid #E5E5EA;
    }
    .tx-item:last-child { border-bottom: none; }
    
    .tx-info h4 { font-size: 16px; font-weight: 600; }
    .tx-info p { font-size: 13px; color: var(--text-secondary); }

    .tx-amount { text-align: right; }
    .amt-val { font-weight: 700; font-size: 16px; }
    
    /* Status Badges */
    .badge {
      font-size: 11px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 6px;
      text-transform: uppercase;
    }
    .badge-approve { background: #E1F5E8; color: var(--system-green); }
    .badge-review { background: #FFF4E5; color: var(--system-orange); }
    .badge-block { background: #FFE5E5; color: var(--system-red); }

    /* Floating Tab Bar */
    .tab-bar {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 380px;
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 30px;
      display: flex;
      padding: 8px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      z-index: 1000;
    }

    .tab-item {
      flex: 1;
      border: none;
      background: none;
      padding: 12px;
      border-radius: 22px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      color: var(--text-secondary);
      font-size: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    .tab-item.active {
      background: var(--card-white);
      color: var(--system-blue);
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    /* Form Styling */
    .form-group { margin-bottom: 20px; }
    label { display: block; font-size: 14px; font-weight: 600; margin-bottom: 8px; margin-left: 4px; }
    input, select {
      width: 100%;
      background: #F2F2F7;
      border: none;
      padding: 16px;
      border-radius: 14px;
      font-size: 17px;
      outline: none;
    }
    input:focus { box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2); }

    .btn-primary {
      width: 100%;
      background: var(--system-blue);
      color: white;
      border: none;
      padding: 18px;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition-spring);
    }
    .btn-primary:active { transform: scale(0.96); opacity: 0.9; }

    /* Accessibility: Focus rings for keyboard users */
    *:focus-visible {
      outline: 2px solid var(--system-blue);
      outline-offset: 4px;
    }
  </style>
</head>
<body>

<div class="app-container">
  
  <main id="view-dashboard" class="fade-in">
    <h1>Analytics</h1>
    
    <div class="card">
      <p class="balance-label">Total Volume</p>
      <div class="balance-val" id="totalVolume">$0.00</div>
      <p style="color: var(--system-red); font-size: 14px; font-weight: 500;">
        <i class="fa-solid fa-triangle-exclamation"></i> High Risk: <span id="highRiskAmount">$0.00</span>
      </p>
      
      <div class="action-row">
        <button class="btn-capsule"><i class="fa-solid fa-chart-line"></i> Report</button>
        <button class="btn-capsule"><i class="fa-solid fa-shield-halved"></i> Rules</button>
      </div>
    </div>

    <div style="display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px;">
        <div class="card" style="min-width: 120px; margin-bottom:0; flex:1; text-align: center;">
            <p class="balance-label">Pass</p>
            <p id="approvedTotal" style="font-weight:700; font-size:18px;">$0</p>
        </div>
        <div class="card" style="min-width: 120px; margin-bottom:0; flex:1; text-align: center;">
            <p class="balance-label">Review</p>
            <p id="reviewedTotal" style="font-weight:700; font-size:18px; color: var(--system-orange);">$0</p>
        </div>
    </div>

    <h2>Activity</h2>
    <div class="card" id="historyContainer">
      </div>
  </main>

  <main id="view-evaluate" class="fade-in" style="display:none;">
    <h1>New Review</h1>
    <div class="card">
      <form id="evaluateForm">
        <div class="form-group">
          <label for="accountId">Account ID</label>
          <input type="text" id="accountId" placeholder="e.g. 8829-X" required>
        </div>
        <div class="form-group">
          <label for="amount">Transaction Amount (USD)</label>
          <input type="number" id="amount" placeholder="0.00" step="0.01" required>
        </div>
        <div class="form-group">
          <label for="country">Merchant Location</label>
          <select id="country" required>
            <option value="US">United States</option>
            <option value="GB">United Kingdom</option>
            <option value="IRAN">Iran (Sanctioned)</option>
            <option value="SYRIA">Syria (Sanctioned)</option>
          </select>
        </div>
        <button type="submit" class="btn-primary">Evaluate Risk</button>
      </form>
    </div>
    <div id="resultCard" class="card fade-in" style="display:none; border-left: 5px solid var(--system-blue);">
        <h4 id="resultTitle">Analysis Complete</h4>
        <p id="resultBody" style="margin-top:8px; font-size:14px; line-height:1.5;"></p>
    </div>
  </main>

  <nav class="tab-bar" role="tablist">
    <button class="tab-item active" onclick="switchTab('dashboard')" id="tab-dashboard" role="tab" aria-selected="true">
      <i class="fa-solid fa-house-chimney fa-lg"></i>
      <span>Summary</span>
    </button>
    <button class="tab-item" onclick="switchTab('evaluate')" id="tab-evaluate" role="tab" aria-selected="false">
      <i class="fa-solid fa-magnifying-glass-chart fa-lg"></i>
      <span>Inspect</span>
    </button>
  </nav>

</div>

<script>
    // Configuration & Data
    const API_BASE = 'https://aml-fraud-detection-api.onrender.com';
    let evaluations = [
        { id: '1', account_id: '1234Z', amount: 1250.00, country: 'US', decision: 'APPROVE', description: 'Apple Store', date: new Date().toISOString() },
        { id: '2', account_id: '9921B', amount: 4500.00, country: 'IRAN', decision: 'BLOCK', description: 'Unrecognized Wire', date: new Date().toISOString() }
    ];

    // UI Logic
    function switchTab(tab) {
        const dash = document.getElementById('view-dashboard');
        const evalView = document.getElementById('view-evaluate');
        const tabs = document.querySelectorAll('.tab-item');
        
        tabs.forEach(t => t.classList.remove('active'));

        if(tab === 'dashboard') {
            dash.style.display = 'block';
            evalView.style.display = 'none';
            document.getElementById('tab-dashboard').classList.add('active');
            updateUI();
        } else {
            dash.style.display = 'none';
            evalView.style.display = 'block';
            document.getElementById('tab-evaluate').classList.add('active');
        }
    }

    function formatCurrency(val) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val);
    }

    function updateUI() {
        const container = document.getElementById('historyContainer');
        let total = 0, highRisk = 0, appvd = 0, revwd = 0;

        container.innerHTML = evaluations.map(tx => {
            total += tx.amount;
            if(tx.decision !== 'APPROVE') highRisk += tx.amount;
            if(tx.decision === 'APPROVE') appvd += tx.amount;
            if(tx.decision === 'REVIEW') revwd += tx.amount;

            const badgeClass = tx.decision.toLowerCase();
            return `
                <div class="tx-item">
                    <div class="tx-info">
                        <h4>${tx.description || 'Global Transfer'}</h4>
                        <p>${tx.account_id} • ${tx.country}</p>
                    </div>
                    <div class="tx-amount">
                        <div class="amt-val">-${formatCurrency(tx.amount)}</div>
                        <span class="badge badge-${badgeClass}">${tx.decision}</span>
                    </div>
                </div>
            `;
        }).reverse().join('');

        document.getElementById('totalVolume').textContent = formatCurrency(total);
        document.getElementById('highRiskAmount').textContent = formatCurrency(highRisk);
        document.getElementById('approvedTotal').textContent = formatCurrency(appvd);
        document.getElementById('reviewedTotal').textContent = formatCurrency(revwd);
    }

    // Form Handling
    document.getElementById('evaluateForm').onsubmit = async (e) => {
        e.preventDefault();
        const btn = e.target.querySelector('button');
        btn.textContent = "Analyzing...";
        
        const payload = {
            account_id: document.getElementById('accountId').value,
            amount: parseFloat(document.getElementById('amount').value),
            country: document.getElementById('country').value
        };

        // Mocking API logic for speed & stability in demo
        setTimeout(() => {
            let decision = "APPROVE";
            if(payload.amount > 10000) decision = "REVIEW";
            if(["IRAN", "SYRIA", "NORTH_KOREA"].includes(payload.country)) decision = "BLOCK";

            const newTx = {
                ...payload,
                id: Date.now().toString(),
                decision: decision,
                description: "Manual Review",
                date: new Date().toISOString()
            };

            evaluations.push(newTx);
            btn.textContent = "Evaluate Risk";
            
            const resCard = document.getElementById('resultCard');
            resCard.style.display = 'block';
            resCard.style.borderLeftColor = decision === 'APPROVE' ? 'var(--system-green)' : 'var(--system-red)';
            document.getElementById('resultBody').innerHTML = `
                <strong>Decision: ${decision}</strong><br>
                The transaction for ${formatCurrency(payload.amount)} was flagged based on ${payload.country} protocols.
            `;
            
            // Haptic feedback simulation
            if (window.navigator.vibrate) window.navigator.vibrate(10);
        }, 800);
    };

    // Initial Load
    updateUI();
</script>

</body>
</html>
